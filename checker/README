
== PHP Open Graph checker ==

This is a utility for checking Open Graph Protocol (OGP) content.

It also may be useful for comparing the behaviour of OGP-related software, 
in particular parsers. 

 
=== Testcases ===

The distribution includes a 'testcases/' collection of files 
that explore various cornercase areas of the OGP specification.

Each testcase consisted of a cached HTML document, plus a corresponding
metadata file in JSON notation. For example, we have a testcase named 
'good' in the 'fb/examples/' sub-collection:

 fb/examples/good.cache
 fb/examples/good.meta

...corresponding to an example published as part of Facebook's Lint service.

In the good.meta file we have the following metadata. Note that this 
metadata format is arbitrary and may evolve, and is unrelated to OGP itself.

{ 
 "url": "http://developers.facebook.com/tools/lint/examples/good",
    "testid": "good",
    "testgroup": "fb/examples",
    "cache_date": "Sun 14 Nov 2010 13:46:47 CET",
    "status": "valid",
    "valid_html": false,
    "uses_rdfa": true,
    "uses_og": true,
    "extended": true,
    "triple_count": 4,
    "home_site": "http://www.facebook.com/"
}

This JSON metadata is read by the checker to ensure a fixed target for software
testing, since Websites may be unavailable, or change unexpectedly.

In cases where there is no public canonical URL for a test, the 'url' metadata
field may be a relative reference. For example, in testcases/ogp/eg1.meta we 
have: "url": "/testcases/ogp/eg1.cache" ...which is resolved at runtime by
the checker, if the local testcase repository is http-accessible.

Future versions might include file:/// access to these tests, or a canonical
location for them (eg. github). Suggestions welcomed. If relative links 
are inaccessible, this will be caught by the system unit tests (see below).


=== Unit Tests ===

This distribution includes a collection of phpunit unit tests which 
exercise various aspects of this software. The intended 'division of labour'
is that the unit tests check this software, the testcases/ document key
design points for Open Graph Protocol data, and that the various checking
functions in the codebase. 

On a good day:

TellyClub:checker danbri$ ./units.sh 
PHPUnit 3.5.5 by Sebastian Bergmann.

OGDataGraphTest
......................

Time: 6 seconds, Memory: 8.00Mb

OK (22 tests, 50 assertions)
 

=== Developer API ===

See OGDataGraphTests.php for examples of the API being tested.

The API is a work-in-progress. For now:



The basic idea is that we have a class DataGraph that deals with reading
and managing an 'open graph' of data.

The initial release uses two plugins as readers. They have different 
strengths and weaknesses.

A 'lite' reader based on Scott MacVicar's (Apache licensed) OpenGraph.php.
A 'full' reader based on Benjamin Nowack's (W3C licensed) ARC RDFa parser.

These are both included in the plugins/ directory for convenience.

There is also partial code and tests for invoking the raptor (redland) RDFa parser
on the commandline. In future versions it would be attractive to include a more
general abstract API for integrating external parsers.
